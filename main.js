!function(){"use strict";class e{constructor(e){let{name:t,link:r,_id:i,isLiked:n}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".card",{handleImageClick:o,likeCallback:a,deleteCallback:l}=arguments.length>2?arguments[2]:void 0;this._name=t,this._link=r,this._id=i,this.isLiked=n,this._cardSelector=s,this._handleImageClick=o,this._deleteCallback=l,this._likeCallback=a,this._cardSelectors={name:`${s}__name`,image:`${s}__image`,likeButton:`${s}__like-btn`,deleteButton:`${s}__delete-btn`},this.init()}_likeButtonHandler=e=>{this._likeCallback().then((()=>{this.isLiked=!this.isLiked,this.updateLike()})).catch((e=>console.error(`Error: ${e}`)))};_deleteButtonHandler=e=>{this._deleteCallback()};_setEventListeners=()=>{this._likeButton.addEventListener("click",this._likeButtonHandler),this._deleteButton.addEventListener("click",this._deleteButtonHandler),this._imageElement.addEventListener("click",(()=>{this._handleImageClick(this)}))};init=()=>(this._cardElement=document.querySelector("#card-template").content.querySelector(this._cardSelector).cloneNode(!0),this._likeButton=this._cardElement.querySelector(this._cardSelectors.likeButton),this._deleteButton=this._cardElement.querySelector(this._cardSelectors.deleteButton),this._imageElement=this._cardElement.querySelector(this._cardSelectors.image),this._nameElement=this._cardElement.querySelector(this._cardSelectors.name),this._imageElement.alt=this._name,this._imageElement.src=this._link,this._nameElement.textContent=this._name,this._cardElement.id=this._id,this._setEventListeners(),this._cardElement);delete(){this._cardElement.remove()}updateLike(){this.isLiked?this._likeButton.classList.add("card__like-btn_mode_liked"):this._likeButton.classList.remove("card__like-btn_mode_liked")}getCard=()=>({name:this._name,link:this._link,element:this._cardElement,id:this._id})}const t=new class{constructor(e){let{nameElement:t,jobElement:r,pfpElement:i}=e;this._nameElement=t,this._jobElement=r,this._pfpElement=i}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,pfpURL:this._pfpElement.src}}setUserInfo(e){let{name:t,job:r,id:i,pfpURL:n}=e;t&&(this._nameElement.textContent=t),r&&(this._jobElement.textContent=r),i&&(this._id=i),n&&(this._pfpElement.src=n)}}({nameElement:document.querySelector(".profile__name"),jobElement:document.querySelector(".profile__job"),pfpElement:document.querySelector(".profile__avatar")});class r{constructor(e){let{popupSelector:t}=e;this._popup=document.querySelector(t),this._popupExitButton=this._popup.querySelector(".popup__exit-btn"),this._isOpened=!1,this._popupContainerClass="popup",this._openedPopupClass="popup_opened"}open(){this._popup.classList.add(this._openedPopupClass),document.addEventListener("keydown",this._handleEscClose),this._isOpened=!0}close(){this._popup.classList.remove(this._openedPopupClass),document.removeEventListener("keydown",this._handleEscClose),this._isOpened=!1}toggle(){this._popup.classList.toggle(this._openedPopupClass),this._isOpened=!this._isOpened}_handleEscClose=e=>{"Escape"==e.key&&this._isOpened&&this.close()};_handleBackdropClose=e=>{e.target.classList.contains(this._popupContainerClass)&&this.close()};setEventListeners(){this._popup.addEventListener("click",this._handleBackdropClose),this._popupExitButton.addEventListener("click",(()=>{this.close()}))}}class i extends r{constructor(e,t){let{popupSelector:r}=e;super({popupSelector:r}),this._submitCallback=t,this._formInputSelector=".form__input",this._formElement=this._popup.querySelector(".form"),this._inputElements=Array.from(this._popup.querySelectorAll(this._formInputSelector)),this._formSubmit=this._formElement.querySelector(".form__submit")}_getInputValues=()=>{const e={};return this._inputElements.forEach((t=>{e[t.id]=t.value})),e};setInputValues(e){this._inputElements.forEach((t=>{t.value=e[t.id]}))}getFormValidator(e){return e[this._formElement.getAttribute("name")]}getForm(){return this._formElement}updateFormSubmit(e){this._formSubmit.textContent=e}setEventListeners=()=>{super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitCallback(this._getInputValues())}))}}class n{constructor(e,t){this._config=e,this._formElement=t,this._submitButtonElement=t.querySelector(e.submitButtonSelector),this._inputList=t.querySelectorAll(this._config.inputSelector)}_isInputValid=e=>!e.validity.valid;_hasInvalidInput=()=>Array.from(this._inputList).some((e=>this._isInputValid(e)));_showInputError=(e,t)=>{const r=this._formElement.querySelector(this._config.errorInputPrefixSelector+e.id);r.textContent=t,r.classList.add(this._config.errorClass),e.classList.add(this._config.inputErrorClass)};_hideInputError=e=>{this._formElement.querySelector(this._config.errorInputPrefixSelector+e.id).classList.remove(this._config.errorClass),e.classList.remove(this._config.inputErrorClass)};disableSubmitButton(){arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?(this._submitButtonElement.classList.remove(this._config.inactiveButtonClass),this._submitButtonElement.removeAttribute("disabled")):(this._submitButtonElement.classList.add(this._config.inactiveButtonClass),this._submitButtonElement.setAttribute("disabled",""))}reset(){this._formElement.reset()}hideInputErrors(){this._inputList.forEach((e=>this._hideInputError(e)))}getFormElement(){return this._formElement}_toggleButtonState=()=>{const e=this._hasInvalidInput();this.disableSubmitButton(e)};_checkInputValidity=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_setEventListeners=()=>{this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))};enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e,t){let{items:r,renderer:i}=e;this._renderedItems=r,this._renderer=i,this._container=document.querySelector(t)}addItem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";this._container[t](e)}clear(){this._container.innerHTML=""}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}}let o;const a=new class{constructor(e){let{baseUrl:t,authToken:r}=e;this._apiURL=t,this._authToken=r}apiCall(e){let{endpoint:t,method:r,body:i={}}=e;const n={method:r,headers:{authorization:this._authToken,"Content-Type":"application/json"}};var s;return s=i,0!==Object.keys(s).length&&(n.body=JSON.stringify(i)),fetch(this._apiURL+t,n).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.statusText}`)))}getUser(){return this.apiCall({endpoint:"/users/me",method:"GET"})}getCards(){return this.apiCall({endpoint:"/cards",method:"GET"})}updateProfile(e){let{name:t,about:r}=e;return this.apiCall({endpoint:"/users/me",method:"PATCH",body:{name:t,about:r}})}updateProfilePicture(e){let{url:t}=e;return this.apiCall({endpoint:"/users/me/avatar",method:"PATCH",body:{avatar:t}})}addCard(e){let{name:t,url:r}=e;return this.apiCall({endpoint:"/cards",method:"POST",body:{name:t,link:r}})}deleteCard(e){let{cardId:t}=e;return this.apiCall({endpoint:`/cards/${t}`,method:"DELETE"})}like(e){let{cardId:t}=e;return this.apiCall({endpoint:`/cards/${t}/likes`,method:"PUT"})}unlike(e){let{cardId:t}=e;return this.apiCall({endpoint:`/cards/${t}/likes`,method:"DELETE"})}deleteAllCards(){this.getInitialCards().then((e=>{const t=e.map((e=>this.deleteCard({cardId:e._id})));return Promise.all(t)})).then((()=>{console.log("All cards have been deleted!")}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",authToken:"7fef8830-65a5-4840-8327-1cd6adab3c4d"}),l={};var d;d={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit",errorInputPrefixSelector:".form__input-error_",inactiveButtonClass:"form__submit_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},Array.from(document.forms).forEach((e=>{const t=e.getAttribute("name"),r=new n(d,e);l[t]=r,r.enableValidation()}));const u=new i({popupSelector:".popup--delete-card"},(()=>(u.updateFormSubmit("Deleting..."),u.getFormValidator(l).disableSubmitButton(),a.deleteCard({cardId:o.getCard().id}).then((()=>(o.delete(),Promise.resolve()))).then((()=>{u.getFormValidator(l).disableSubmitButton(),u.close()})).catch((e=>{u.updateFormSubmit("Error - Try Again"),u.getFormValidator(l).disableSubmitButton(!1),console.error(`Error: ${e}`)})))));function c(t){const r=new e(t,".card",{handleImageClick:()=>{b.open({name:t.name,url:t.link})},deleteCallback:()=>{o=r,u.updateFormSubmit("Delete"),u.open(),u.getFormValidator(l).disableSubmitButton(!1)},likeCallback:()=>r.isLiked?a.unlike({cardId:r.getCard().id}):a.like({cardId:r.getCard().id})});return r.updateLike(),r.getCard().element}u.setEventListeners(),a.getUser().then((e=>{t.setUserInfo({name:e.name,job:e.about,id:e._id,pfpURL:e.avatar})})).catch((e=>{t.setUserInfo({name:"Error: Not Found",job:"Error: Not Found"}),console.error(`Error: ${e}`)}));let p=null;a.getCards().then((e=>{p=new s({items:e,renderer:e=>p.addItem(c(e),"append")},".gallery"),p.clear(),p.renderItems()})).catch((e=>console.error(`Error: ${e}`)));const m=document.querySelector(".profile__edit-name-button"),h=new i({popupSelector:".popup--edit-profile"},(e=>{h.updateFormSubmit("Saving..."),h.getFormValidator(l).disableSubmitButton(),a.updateProfile({name:e.name,about:e.job}).then((e=>{t.setUserInfo({name:e.name,job:e.about}),h.close()})).catch((e=>{h.updateFormSubmit("Error - Try Again"),h.getFormValidator(l).disableSubmitButton(!1),console.error(`Error: ${e}`)}))}));h.setEventListeners(),m.addEventListener("click",(()=>{h.setInputValues({name:t.getUserInfo().name,job:t.getUserInfo().job}),h.updateFormSubmit("Save"),h.getFormValidator(l).disableSubmitButton(),h.open()}));const _=document.querySelector(".profile__add-button"),E=new i({popupSelector:".popup--new-place"},(e=>{E.updateFormSubmit("Creating..."),E.getFormValidator(l).disableSubmitButton(),a.addCard({name:e["place-name"],url:e["place-url"]}).then((e=>(p.addItem(c(e)),Promise.resolve()))).then((()=>{E.getFormValidator(l).reset(),E.close()})).catch((e=>{E.updateFormSubmit("Error - Try Again"),E.getFormValidator(l).disableSubmitButton(!1),console.error(`Error: ${e}`)}))}));_.addEventListener("click",(()=>{E.updateFormSubmit("Create"),E.open()})),E.setEventListeners();const b=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._image=this._popup.querySelector(".popup__image"),this._imageCaption=this._popup.querySelector(".popup__place-name")}open(e){let{name:t,url:r}=e;this._imageCaption.textContent=t,this._image.alt=t,this._image.src=r,super.open()}}({popupSelector:".popup--open-image"});b.setEventListeners();const g=document.querySelector(".profile__avatar-container"),f=(document.querySelector(".profile__avatar"),new i({popupSelector:".popup--change-pfp"},(e=>{f.updateFormSubmit("Updating..."),f.getFormValidator(l).disableSubmitButton(),a.updateProfilePicture({url:e["pfp-url"]}).then((e=>{t.setUserInfo({pfpURL:e.avatar}),f.getFormValidator(l).reset(),f.close()})).catch((e=>{console.error(`Error: ${e}`),f.getFormValidator(l).disableSubmitButton(!1),f.updateFormSubmit("Error - Try Again")}))})));f.setEventListeners(),g.addEventListener("click",(()=>{f.open(),f.updateFormSubmit("Update")}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFjNUssWUFBYzdDLEVBQ2pDVyxLQUFLNk0sT0FBTzdLLElBQU0zQyxFQUNsQlcsS0FBSzZNLE9BQU81SyxJQUFNMEksRUFDbEJuRyxNQUFNWixNQUNSLEdIc0xvQyxDQUNwQ04sY0FBZSx1QkFFakIrSSxFQUFXaEksb0JBR1gsTUFBTTBJLEVBQVlwTCxTQUFTQyxjQUFjLDhCQUVuQ29MLEdBRFdyTCxTQUFTQyxjQUFjLG9CQUN2QixJQUFJMEMsRUFDbkIsQ0FBRWhCLGNBQWUsdUJBQ2hCaUMsSUFDQ3lILEVBQVNuSCxpQkFBaUIsZUFDMUJtSCxFQUFTdkgsaUJBQWlCbUcsR0FBZ0J6RSxzQkFDMUMwQixFQUNHNEIscUJBQXFCLENBQUVFLElBQUtwRixFQUFLLGFBQ2pDekUsTUFBTWdKLElBQ0xwSCxFQUFTUyxZQUFZLENBQUVELE9BQVE0RyxFQUFJYyxTQUNuQ29DLEVBQVN2SCxpQkFBaUJtRyxHQUFnQnJFLFFBQzFDeUYsRUFBU2xKLE9BQU8sSUFFakI5QyxPQUFPQyxJQUNOQyxRQUFRQyxNQUFNLFVBQVVGLEtBQ3hCK0wsRUFBU3ZILGlCQUFpQm1HLEdBQWdCekUscUJBQW9CLEdBQzlENkYsRUFBU25ILGlCQUFpQixvQkFBb0IsR0FDOUMsS0FHUm1ILEVBQVMzSSxvQkFDVDBJLEVBQVV4TCxpQkFBaUIsU0FBUyxLQUNsQ3lMLEVBQVNwSixPQUNUb0osRUFBU25ILGlCQUFpQixTQUFTLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgeyBuYW1lLCBsaW5rLCBfaWQsIGlzTGlrZWQgfSxcbiAgICBjYXJkU2VsZWN0b3IgPSBcIi5jYXJkXCIsXG4gICAgeyBoYW5kbGVJbWFnZUNsaWNrLCBsaWtlQ2FsbGJhY2ssIGRlbGV0ZUNhbGxiYWNrIH1cbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5faWQgPSBfaWQ7XG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5fZGVsZXRlQ2FsbGJhY2sgPSBkZWxldGVDYWxsYmFjaztcbiAgICB0aGlzLl9saWtlQ2FsbGJhY2sgPSBsaWtlQ2FsbGJhY2s7XG5cbiAgICB0aGlzLl9jYXJkU2VsZWN0b3JzID0ge1xuICAgICAgbmFtZTogYCR7Y2FyZFNlbGVjdG9yfV9fbmFtZWAsXG4gICAgICBpbWFnZTogYCR7Y2FyZFNlbGVjdG9yfV9faW1hZ2VgLFxuICAgICAgbGlrZUJ1dHRvbjogYCR7Y2FyZFNlbGVjdG9yfV9fbGlrZS1idG5gLFxuICAgICAgZGVsZXRlQnV0dG9uOiBgJHtjYXJkU2VsZWN0b3J9X19kZWxldGUtYnRuYCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICBfbGlrZUJ1dHRvbkhhbmRsZXIgPSAoZXZ0KSA9PiB7XG4gICAgdGhpcy5fbGlrZUNhbGxiYWNrKClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy5pc0xpa2VkID0gIXRoaXMuaXNMaWtlZDtcbiAgICAgICAgdGhpcy51cGRhdGVMaWtlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYEVycm9yOiAke2Vycn1gKSk7XG4gIH07XG5cbiAgX2RlbGV0ZUJ1dHRvbkhhbmRsZXIgPSAoZXZ0KSA9PiB7XG4gICAgdGhpcy5fZGVsZXRlQ2FsbGJhY2soKTtcbiAgfTtcblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgLy8gTGlrZSBCdXR0b24gTG9naWNcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9saWtlQnV0dG9uSGFuZGxlcik7XG5cbiAgICAvLyBEZWxldGUgQnV0dG9uIExvZ2ljXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9kZWxldGVCdXR0b25IYW5kbGVyKTtcblxuICAgIC8vIEltYWdlIE1vZGFsIEJ1dHRvbiBMb2dpY1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzKTtcbiAgICB9KTtcbiAgfTtcblxuICBpbml0ID0gKCkgPT4ge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fY2FyZFNlbGVjdG9ycy5saWtlQnV0dG9uXG4gICAgKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fY2FyZFNlbGVjdG9ycy5kZWxldGVCdXR0b25cbiAgICApO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jYXJkU2VsZWN0b3JzLmltYWdlXG4gICAgKTtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jYXJkU2VsZWN0b3JzLm5hbWVcbiAgICApO1xuXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQuaWQgPSB0aGlzLl9pZDtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH07XG5cbiAgZGVsZXRlKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgdXBkYXRlTGlrZSgpIHtcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ0bl9tb2RlX2xpa2VkXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ0bl9tb2RlX2xpa2VkXCIpO1xuICAgIH1cbiAgfVxuXG4gIGdldENhcmQgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUsXG4gICAgICBsaW5rOiB0aGlzLl9saW5rLFxuICAgICAgZWxlbWVudDogdGhpcy5fY2FyZEVsZW1lbnQsXG4gICAgICBpZDogdGhpcy5faWQsXG4gICAgfTtcbiAgfTtcbn1cbiIsImltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuXG5jb25zdCBjYXJkTGlzdCA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG4vLyAtLSBGb3JtIFZhbGlkYXRvclxuY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX3N1Ym1pdFwiLFxuICBlcnJvcklucHV0UHJlZml4U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0LWVycm9yX1wiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX3N1Ym1pdF9pbmFjdGl2ZVwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxufTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lRWxlbWVudDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpLFxuICBqb2JFbGVtZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2pvYlwiKSxcbiAgcGZwRWxlbWVudDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIiksXG59KTtcblxuZXhwb3J0IHsgY2FyZExpc3QsIGNvbmZpZywgdXNlckluZm8gfTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lRWxlbWVudCwgam9iRWxlbWVudCwgcGZwRWxlbWVudCB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBuYW1lRWxlbWVudDtcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gam9iRWxlbWVudDtcbiAgICB0aGlzLl9wZnBFbGVtZW50ID0gcGZwRWxlbWVudDtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIHBmcFVSTDogdGhpcy5fcGZwRWxlbWVudC5zcmMsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iLCBpZCwgcGZwVVJMIH0pIHtcbiAgICBpZiAobmFtZSkgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIGlmIChqb2IpIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBqb2I7XG4gICAgaWYgKGlkKSB0aGlzLl9pZCA9IGlkO1xuICAgIGlmIChwZnBVUkwpIHRoaXMuX3BmcEVsZW1lbnQuc3JjID0gcGZwVVJMO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwRXhpdEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2V4aXQtYnRuXCIpO1xuICAgIHRoaXMuX2lzT3BlbmVkID0gZmFsc2U7XG5cbiAgICB0aGlzLl9wb3B1cENvbnRhaW5lckNsYXNzID0gXCJwb3B1cFwiO1xuICAgIHRoaXMuX29wZW5lZFBvcHVwQ2xhc3MgPSBcInBvcHVwX29wZW5lZFwiO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKHRoaXMuX29wZW5lZFBvcHVwQ2xhc3MpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9pc09wZW5lZCA9IHRydWU7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX29wZW5lZFBvcHVwQ2xhc3MpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9pc09wZW5lZCA9IGZhbHNlO1xuICB9XG5cbiAgdG9nZ2xlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC50b2dnbGUodGhpcy5fb3BlbmVkUG9wdXBDbGFzcyk7XG4gICAgdGhpcy5faXNPcGVuZWQgPSAhdGhpcy5faXNPcGVuZWQ7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT0gXCJFc2NhcGVcIikge1xuICAgICAgaWYgKHRoaXMuX2lzT3BlbmVkKSB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIF9oYW5kbGVCYWNrZHJvcENsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyh0aGlzLl9wb3B1cENvbnRhaW5lckNsYXNzKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQmFja2Ryb3BDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXBFeGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSwgc3VibWl0Q2FsbGJhY2spIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fc3VibWl0Q2FsbGJhY2sgPSBzdWJtaXRDYWxsYmFjaztcblxuICAgIHRoaXMuX2Zvcm1JbnB1dFNlbGVjdG9yID0gXCIuZm9ybV9faW5wdXRcIjtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fZm9ybUlucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9mb3JtU3VibWl0ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zdWJtaXRcIik7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMgPSAoKSA9PiB7XG4gICAgY29uc3QgdmFsdWVzID0ge307XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdmFsdWVzW2lucHV0RWxlbWVudC5pZF0gPSBpbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdmFsdWVzO1xuICB9O1xuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQuaWRdO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0Rm9ybVZhbGlkYXRvcih2YWxpZGF0b3JzKSB7XG4gICAgcmV0dXJuIHZhbGlkYXRvcnNbdGhpcy5fZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKV07XG4gIH1cblxuICBnZXRGb3JtKCkge1xuICAgIHJldHVybiB0aGlzLl9mb3JtRWxlbWVudDtcbiAgfVxuXG4gIHVwZGF0ZUZvcm1TdWJtaXQodmFsdWUpIHtcbiAgICB0aGlzLl9mb3JtU3VibWl0LnRleHRDb250ZW50ID0gdmFsdWU7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9zdWJtaXRDYWxsYmFjayh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWcuaW5wdXRTZWxlY3Rvcik7XG4gIH1cblxuICBfaXNJbnB1dFZhbGlkID0gKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcblxuICBfaGFzSW52YWxpZElucHV0ID0gKCkgPT5cbiAgICBBcnJheS5mcm9tKHRoaXMuX2lucHV0TGlzdCkuc29tZSgoaW5wdXRFbGVtZW50KSA9PlxuICAgICAgdGhpcy5faXNJbnB1dFZhbGlkKGlucHV0RWxlbWVudClcbiAgICApO1xuXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jb25maWcuZXJyb3JJbnB1dFByZWZpeFNlbGVjdG9yICsgaW5wdXRFbGVtZW50LmlkXG4gICAgKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fY29uZmlnLmVycm9ySW5wdXRQcmVmaXhTZWxlY3RvciArIGlucHV0RWxlbWVudC5pZFxuICAgICk7XG5cbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgZGlzYWJsZVN1Ym1pdEJ1dHRvbihmbGFnID0gdHJ1ZSkge1xuICAgIGlmIChmbGFnKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFxuICAgICAgICB0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzc1xuICAgICAgKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9XG5cbiAgcmVzZXQoKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgfVxuXG4gIGhpZGVJbnB1dEVycm9ycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PlxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KVxuICAgICk7XG4gIH1cblxuICBnZXRGb3JtRWxlbWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5fZm9ybUVsZW1lbnQ7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUgPSAoKSA9PiB7XG4gICAgY29uc3QgaXNGb3JtSW52YWxpZCA9IHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpO1xuXG4gICAgdGhpcy5kaXNhYmxlU3VibWl0QnV0dG9uKGlzRm9ybUludmFsaWQpO1xuICB9O1xuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH07XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQsIG1ldGhvZCA9IFwicHJlcGVuZFwiKSB7XG4gICAgdGhpcy5fY29udGFpbmVyW21ldGhvZF0oZWxlbWVudCk7XG4gIH1cblxuICBjbGVhcigpIHtcbiAgICB0aGlzLl9jb250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgY29uZmlnLCB1c2VySW5mbyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcblxubGV0IGN1cnJlbnRDYXJkID0gdW5kZWZpbmVkO1xuXG4vLyBBUElcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGF1dGhUb2tlbjogXCI3ZmVmODgzMC02NWE1LTQ4NDAtODMyNy0xY2Q2YWRhYjNjNGRcIixcbn0pO1xuXG4vLyBGb3JtIFZhbGlkYXRpb25cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQuZm9ybXMpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1FbGVtZW50KTtcblxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5lbmFibGVWYWxpZGF0aW9uKGNvbmZpZyk7XG5cbi8vIERlbGV0ZSBjYXJkIFBvcHVwXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAge1xuICAgIHBvcHVwU2VsZWN0b3I6IFwiLnBvcHVwLS1kZWxldGUtY2FyZFwiLFxuICB9LFxuICAoKSA9PiB7XG4gICAgZGVsZXRlQ2FyZFBvcHVwLnVwZGF0ZUZvcm1TdWJtaXQoXCJEZWxldGluZy4uLlwiKTtcbiAgICBkZWxldGVDYXJkUG9wdXAuZ2V0Rm9ybVZhbGlkYXRvcihmb3JtVmFsaWRhdG9ycykuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICAgIHJldHVybiBhcGlcbiAgICAgIC5kZWxldGVDYXJkKHtcbiAgICAgICAgY2FyZElkOiBjdXJyZW50Q2FyZC5nZXRDYXJkKCkuaWQsXG4gICAgICB9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjdXJyZW50Q2FyZC5kZWxldGUoKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgfSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmdldEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRvcnMpLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLnVwZGF0ZUZvcm1TdWJtaXQoXCJFcnJvciAtIFRyeSBBZ2FpblwiKTtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwXG4gICAgICAgICAgLmdldEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRvcnMpXG4gICAgICAgICAgLmRpc2FibGVTdWJtaXRCdXR0b24oZmFsc2UpO1xuXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yOiAke2Vycn1gKTtcbiAgICAgIH0pO1xuICB9XG4pO1xuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIENyZWF0ZSBjYXJkXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGRhdGEsIFwiLmNhcmRcIiwge1xuICAgIGhhbmRsZUltYWdlQ2xpY2s6ICgpID0+IHtcbiAgICAgIGltYWdlUG9wdXAub3Blbih7IG5hbWU6IGRhdGEubmFtZSwgdXJsOiBkYXRhLmxpbmsgfSk7XG4gICAgfSxcbiAgICBkZWxldGVDYWxsYmFjazogKCkgPT4ge1xuICAgICAgY3VycmVudENhcmQgPSBjYXJkO1xuICAgICAgZGVsZXRlQ2FyZFBvcHVwLnVwZGF0ZUZvcm1TdWJtaXQoXCJEZWxldGVcIik7XG4gICAgICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xuICAgICAgZGVsZXRlQ2FyZFBvcHVwXG4gICAgICAgIC5nZXRGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0b3JzKVxuICAgICAgICAuZGlzYWJsZVN1Ym1pdEJ1dHRvbihmYWxzZSk7XG4gICAgfSxcbiAgICBsaWtlQ2FsbGJhY2s6ICgpID0+IHtcbiAgICAgIHJldHVybiAhY2FyZC5pc0xpa2VkXG4gICAgICAgID8gYXBpLmxpa2UoeyBjYXJkSWQ6IGNhcmQuZ2V0Q2FyZCgpLmlkIH0pXG4gICAgICAgIDogYXBpLnVubGlrZSh7IGNhcmRJZDogY2FyZC5nZXRDYXJkKCkuaWQgfSk7XG4gICAgfSxcbiAgfSk7XG5cbiAgY2FyZC51cGRhdGVMaWtlKCk7XG5cbiAgcmV0dXJuIGNhcmQuZ2V0Q2FyZCgpLmVsZW1lbnQ7XG59XG5cbi8vIFJlbmRlciBhbGwgaW5pdGlhbHMgaW5mb3JtYXRpb24gZnJvbSBBUElcbmFwaVxuICAuZ2V0VXNlcigpXG4gIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICBqb2I6IHVzZXJEYXRhLmFib3V0LFxuICAgICAgaWQ6IHVzZXJEYXRhLl9pZCxcbiAgICAgIHBmcFVSTDogdXNlckRhdGEuYXZhdGFyLFxuICAgIH0pO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IFwiRXJyb3I6IE5vdCBGb3VuZFwiLFxuICAgICAgam9iOiBcIkVycm9yOiBOb3QgRm91bmRcIixcbiAgICB9KTtcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogJHtlcnJ9YCk7XG4gIH0pO1xuXG5sZXQgZ2FsbGVyeSA9IG51bGw7XG5hcGlcbiAgLmdldENhcmRzKClcbiAgLnRoZW4oKGNhcmRzKSA9PiB7XG4gICAgZ2FsbGVyeSA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogY2FyZHMsXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4gZ2FsbGVyeS5hZGRJdGVtKGNyZWF0ZUNhcmQoaXRlbSksIFwiYXBwZW5kXCIpLFxuICAgICAgfSxcbiAgICAgIFwiLmdhbGxlcnlcIlxuICAgICk7XG5cbiAgICBnYWxsZXJ5LmNsZWFyKCk7XG4gICAgZ2FsbGVyeS5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgRXJyb3I6ICR7ZXJyfWApKTtcblxuLy8gQ2hhbmdlIHVzZXIgaW5mb1xuY29uc3QgZWRpdEluZm9Qb3B1cEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2VkaXQtbmFtZS1idXR0b25cIlxuKTtcblxuY29uc3QgdXNlckluZm9Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICB7IHBvcHVwU2VsZWN0b3I6IFwiLnBvcHVwLS1lZGl0LXByb2ZpbGVcIiB9LFxuICAoZGF0YSkgPT4ge1xuICAgIHVzZXJJbmZvUG9wdXAudXBkYXRlRm9ybVN1Ym1pdChcIlNhdmluZy4uLlwiKTtcbiAgICB1c2VySW5mb1BvcHVwLmdldEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRvcnMpLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgICBhcGlcbiAgICAgIC51cGRhdGVQcm9maWxlKHsgbmFtZTogZGF0YS5uYW1lLCBhYm91dDogZGF0YS5qb2IgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lOiByZXMubmFtZSwgam9iOiByZXMuYWJvdXQgfSk7XG4gICAgICAgIHVzZXJJbmZvUG9wdXAuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICB1c2VySW5mb1BvcHVwLnVwZGF0ZUZvcm1TdWJtaXQoXCJFcnJvciAtIFRyeSBBZ2FpblwiKTtcbiAgICAgICAgdXNlckluZm9Qb3B1cFxuICAgICAgICAgIC5nZXRGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0b3JzKVxuICAgICAgICAgIC5kaXNhYmxlU3VibWl0QnV0dG9uKGZhbHNlKTtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3I6ICR7ZXJyfWApO1xuICAgICAgfSk7XG4gIH1cbik7XG51c2VySW5mb1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0SW5mb1BvcHVwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHVzZXJJbmZvUG9wdXAuc2V0SW5wdXRWYWx1ZXMoe1xuICAgIG5hbWU6IHVzZXJJbmZvLmdldFVzZXJJbmZvKCkubmFtZSxcbiAgICBqb2I6IHVzZXJJbmZvLmdldFVzZXJJbmZvKCkuam9iLFxuICB9KTtcbiAgdXNlckluZm9Qb3B1cC51cGRhdGVGb3JtU3VibWl0KFwiU2F2ZVwiKTtcbiAgdXNlckluZm9Qb3B1cC5nZXRGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0b3JzKS5kaXNhYmxlU3VibWl0QnV0dG9uKCk7XG4gIHVzZXJJbmZvUG9wdXAub3BlbigpO1xufSk7XG5cbi8vIEFkZCBuZXcgY2FyZFxuY29uc3QgbmV3UGxhY2VQb3B1cEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmNvbnN0IG5ld1BsYWNlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgeyBwb3B1cFNlbGVjdG9yOiBcIi5wb3B1cC0tbmV3LXBsYWNlXCIgfSxcbiAgKGRhdGEpID0+IHtcbiAgICBuZXdQbGFjZVBvcHVwLnVwZGF0ZUZvcm1TdWJtaXQoXCJDcmVhdGluZy4uLlwiKTtcbiAgICBuZXdQbGFjZVBvcHVwLmdldEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRvcnMpLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgICBhcGlcbiAgICAgIC5hZGRDYXJkKHtcbiAgICAgICAgbmFtZTogZGF0YVtcInBsYWNlLW5hbWVcIl0sXG4gICAgICAgIHVybDogZGF0YVtcInBsYWNlLXVybFwiXSxcbiAgICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGdhbGxlcnkuYWRkSXRlbShjcmVhdGVDYXJkKHJlcykpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBuZXdQbGFjZVBvcHVwLmdldEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRvcnMpLnJlc2V0KCk7XG4gICAgICAgIG5ld1BsYWNlUG9wdXAuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBuZXdQbGFjZVBvcHVwLnVwZGF0ZUZvcm1TdWJtaXQoXCJFcnJvciAtIFRyeSBBZ2FpblwiKTtcbiAgICAgICAgbmV3UGxhY2VQb3B1cFxuICAgICAgICAgIC5nZXRGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0b3JzKVxuICAgICAgICAgIC5kaXNhYmxlU3VibWl0QnV0dG9uKGZhbHNlKTtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3I6ICR7ZXJyfWApO1xuICAgICAgfSk7XG4gIH1cbik7XG5uZXdQbGFjZVBvcHVwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG5ld1BsYWNlUG9wdXAudXBkYXRlRm9ybVN1Ym1pdChcIkNyZWF0ZVwiKTtcbiAgbmV3UGxhY2VQb3B1cC5vcGVuKCk7XG59KTtcbm5ld1BsYWNlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiLnBvcHVwLS1vcGVuLWltYWdlXCIsXG59KTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gVXBkYXRpbmcgUEZQXG5jb25zdCBwZnBCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1jb250YWluZXJcIik7XG5jb25zdCBwZnBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuY29uc3QgcGZwUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgeyBwb3B1cFNlbGVjdG9yOiBcIi5wb3B1cC0tY2hhbmdlLXBmcFwiIH0sXG4gIChkYXRhKSA9PiB7XG4gICAgcGZwUG9wdXAudXBkYXRlRm9ybVN1Ym1pdChcIlVwZGF0aW5nLi4uXCIpO1xuICAgIHBmcFBvcHVwLmdldEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRvcnMpLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgICBhcGlcbiAgICAgIC51cGRhdGVQcm9maWxlUGljdHVyZSh7IHVybDogZGF0YVtcInBmcC11cmxcIl0gfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBwZnBVUkw6IHJlcy5hdmF0YXIgfSk7XG4gICAgICAgIHBmcFBvcHVwLmdldEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRvcnMpLnJlc2V0KCk7XG4gICAgICAgIHBmcFBvcHVwLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3I6ICR7ZXJyfWApO1xuICAgICAgICBwZnBQb3B1cC5nZXRGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0b3JzKS5kaXNhYmxlU3VibWl0QnV0dG9uKGZhbHNlKTtcbiAgICAgICAgcGZwUG9wdXAudXBkYXRlRm9ybVN1Ym1pdChcIkVycm9yIC0gVHJ5IEFnYWluXCIpO1xuICAgICAgfSk7XG4gIH1cbik7XG5wZnBQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xucGZwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHBmcFBvcHVwLm9wZW4oKTtcbiAgcGZwUG9wdXAudXBkYXRlRm9ybVN1Ym1pdChcIlVwZGF0ZVwiKTtcbn0pO1xuIiwiaW1wb3J0IHsgaXNPYmplY3RFbXB0eSB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGF1dGhUb2tlbiB9KSB7XG4gICAgdGhpcy5fYXBpVVJMID0gYmFzZVVybDtcbiAgICB0aGlzLl9hdXRoVG9rZW4gPSBhdXRoVG9rZW47XG4gIH1cblxuICBhcGlDYWxsKHsgZW5kcG9pbnQsIG1ldGhvZCwgYm9keSA9IHt9IH0pIHtcbiAgICBjb25zdCBvcHQgPSB7XG4gICAgICBtZXRob2QsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhUb2tlbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBpZiAoIWlzT2JqZWN0RW1wdHkoYm9keSkpIG9wdC5ib2R5ID0gSlNPTi5zdHJpbmdpZnkoYm9keSk7XG5cbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYXBpVVJMICsgZW5kcG9pbnQsIG9wdCkudGhlbigocmVzKSA9PiB7XG4gICAgICByZXR1cm4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzVGV4dH1gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBpQ2FsbCh7XG4gICAgICBlbmRwb2ludDogXCIvdXNlcnMvbWVcIixcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICB9KTtcbiAgfVxuXG4gIGdldENhcmRzKCkge1xuICAgIHJldHVybiB0aGlzLmFwaUNhbGwoe1xuICAgICAgZW5kcG9pbnQ6IFwiL2NhcmRzXCIsXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVQcm9maWxlKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiB0aGlzLmFwaUNhbGwoe1xuICAgICAgZW5kcG9pbnQ6IFwiL3VzZXJzL21lXCIsXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGJvZHk6IHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlUHJvZmlsZVBpY3R1cmUoeyB1cmwgfSkge1xuICAgIHJldHVybiB0aGlzLmFwaUNhbGwoe1xuICAgICAgZW5kcG9pbnQ6IFwiL3VzZXJzL21lL2F2YXRhclwiLFxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBib2R5OiB7XG4gICAgICAgIGF2YXRhcjogdXJsLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFkZENhcmQoeyBuYW1lLCB1cmwgfSkge1xuICAgIHJldHVybiB0aGlzLmFwaUNhbGwoe1xuICAgICAgZW5kcG9pbnQ6IFwiL2NhcmRzXCIsXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keToge1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rOiB1cmwsXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZCh7IGNhcmRJZCB9KSB7XG4gICAgcmV0dXJuIHRoaXMuYXBpQ2FsbCh7XG4gICAgICBlbmRwb2ludDogYC9jYXJkcy8ke2NhcmRJZH1gLFxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIH0pO1xuICB9XG5cbiAgbGlrZSh7IGNhcmRJZCB9KSB7XG4gICAgcmV0dXJuIHRoaXMuYXBpQ2FsbCh7XG4gICAgICBlbmRwb2ludDogYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLFxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgIH0pO1xuICB9XG5cbiAgdW5saWtlKHsgY2FyZElkIH0pIHtcbiAgICByZXR1cm4gdGhpcy5hcGlDYWxsKHtcbiAgICAgIGVuZHBvaW50OiBgL2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgfSk7XG4gIH1cblxuICBkZWxldGVBbGxDYXJkcygpIHtcbiAgICB0aGlzLmdldEluaXRpYWxDYXJkcygpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBwcm9taXNlQXJyID0gZGF0YS5tYXAoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5kZWxldGVDYXJkKHsgY2FyZElkOiBpdGVtLl9pZCB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VBcnIpO1xuICAgICAgfSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYEFsbCBjYXJkcyBoYXZlIGJlZW4gZGVsZXRlZCFgKTtcbiAgICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gaXNPYmplY3RFbXB0eShvYmopIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwO1xufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3BsYWNlLW5hbWVcIik7XG4gIH1cblxuICBvcGVuKHsgbmFtZSwgdXJsIH0pIHtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gdXJsO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJuYW1lIiwibGluayIsIl9pZCIsImlzTGlrZWQiLCJjYXJkU2VsZWN0b3IiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJoYW5kbGVJbWFnZUNsaWNrIiwibGlrZUNhbGxiYWNrIiwiZGVsZXRlQ2FsbGJhY2siLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9kZWxldGVDYWxsYmFjayIsIl9saWtlQ2FsbGJhY2siLCJfY2FyZFNlbGVjdG9ycyIsImltYWdlIiwibGlrZUJ1dHRvbiIsImRlbGV0ZUJ1dHRvbiIsImluaXQiLCJfbGlrZUJ1dHRvbkhhbmRsZXIiLCJldnQiLCJ0aGVuIiwidXBkYXRlTGlrZSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiX2RlbGV0ZUJ1dHRvbkhhbmRsZXIiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiX2ltYWdlRWxlbWVudCIsIl9jYXJkRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfbmFtZUVsZW1lbnQiLCJhbHQiLCJzcmMiLCJ0ZXh0Q29udGVudCIsImlkIiwiZGVsZXRlIiwicmVtb3ZlIiwiY2xhc3NMaXN0IiwiYWRkIiwiZ2V0Q2FyZCIsImVsZW1lbnQiLCJ1c2VySW5mbyIsIm5hbWVFbGVtZW50Iiwiam9iRWxlbWVudCIsInBmcEVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9wZnBFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJqb2IiLCJwZnBVUkwiLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX3BvcHVwRXhpdEJ1dHRvbiIsIl9pc09wZW5lZCIsIl9wb3B1cENvbnRhaW5lckNsYXNzIiwiX29wZW5lZFBvcHVwQ2xhc3MiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidG9nZ2xlIiwia2V5IiwiX2hhbmRsZUJhY2tkcm9wQ2xvc2UiLCJ0YXJnZXQiLCJjb250YWlucyIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdENhbGxiYWNrIiwic3VwZXIiLCJfc3VibWl0Q2FsbGJhY2siLCJfZm9ybUlucHV0U2VsZWN0b3IiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRFbGVtZW50cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfZm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiZGF0YSIsImlucHV0IiwiZ2V0Rm9ybVZhbGlkYXRvciIsInZhbGlkYXRvcnMiLCJnZXRBdHRyaWJ1dGUiLCJnZXRGb3JtIiwidXBkYXRlRm9ybVN1Ym1pdCIsInByZXZlbnREZWZhdWx0IiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwiX2NvbmZpZyIsIl9zdWJtaXRCdXR0b25FbGVtZW50Iiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5wdXRMaXN0IiwiaW5wdXRTZWxlY3RvciIsIl9pc0lucHV0VmFsaWQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJlcnJvcklucHV0UHJlZml4U2VsZWN0b3IiLCJlcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2hpZGVJbnB1dEVycm9yIiwiZGlzYWJsZVN1Ym1pdEJ1dHRvbiIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJyZXNldCIsImhpZGVJbnB1dEVycm9ycyIsImdldEZvcm1FbGVtZW50IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiaXNGb3JtSW52YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVuYWJsZVZhbGlkYXRpb24iLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsIm1ldGhvZCIsImNsZWFyIiwiaW5uZXJIVE1MIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiY3VycmVudENhcmQiLCJhcGkiLCJiYXNlVXJsIiwiYXV0aFRva2VuIiwiX2FwaVVSTCIsIl9hdXRoVG9rZW4iLCJhcGlDYWxsIiwiZW5kcG9pbnQiLCJib2R5Iiwib3B0IiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJvYmoiLCJPYmplY3QiLCJrZXlzIiwiSlNPTiIsInN0cmluZ2lmeSIsImZldGNoIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJnZXRVc2VyIiwiZ2V0Q2FyZHMiLCJ1cGRhdGVQcm9maWxlIiwiX3JlZjMiLCJhYm91dCIsInVwZGF0ZVByb2ZpbGVQaWN0dXJlIiwiX3JlZjQiLCJ1cmwiLCJhdmF0YXIiLCJhZGRDYXJkIiwiX3JlZjUiLCJkZWxldGVDYXJkIiwiX3JlZjYiLCJjYXJkSWQiLCJsaWtlIiwiX3JlZjciLCJ1bmxpa2UiLCJfcmVmOCIsImRlbGV0ZUFsbENhcmRzIiwiZ2V0SW5pdGlhbENhcmRzIiwicHJvbWlzZUFyciIsIm1hcCIsImFsbCIsImxvZyIsImZvcm1WYWxpZGF0b3JzIiwiZm9ybVNlbGVjdG9yIiwiZm9ybXMiLCJmb3JtTmFtZSIsInZhbGlkYXRvciIsImRlbGV0ZUNhcmRQb3B1cCIsInJlc29sdmUiLCJjcmVhdGVDYXJkIiwiY2FyZCIsImltYWdlUG9wdXAiLCJ1c2VyRGF0YSIsImdhbGxlcnkiLCJjYXJkcyIsImVkaXRJbmZvUG9wdXBCdXR0b24iLCJ1c2VySW5mb1BvcHVwIiwibmV3UGxhY2VQb3B1cEJ1dHRvbiIsIm5ld1BsYWNlUG9wdXAiLCJfaW1hZ2UiLCJfaW1hZ2VDYXB0aW9uIiwicGZwQnV0dG9uIiwicGZwUG9wdXAiXSwic291cmNlUm9vdCI6IiJ9